# Стоимость владения системой с учетом роста данных и базы пользователей

Расчет стоимости владения системой требует учитывать как капитальные затраты (capital expenditure, CAPEX) и операционные (текущие) затраты (operating expenditure, OPEX).

**Составляющие CAPEX:**
- покупка оборудования: серверов, сетевого оборудования, хранилищ данных,
- покупка лицензий программного обеспечения (ПО), например, подписка на платформы разработки мобильных приложений, системы аналитики, CRM, ERP,
- проектирование инфраструктуры: разработка архитектуры сети, установка ПО, настройки безопасности,
- поддержка имеющихся активов: амортизация приобретенного оборудования и ПО,
- расходы на лицензии, патенты и другие интеллектуальные права,
- расходы на обучение и развитие персонала. 

**Составляющие OPEX:**
- зарплата сотрудников: зарплата IT-специалистов, маркетологов, техписателей и тд,
- хостинг и аренда облачных сервисов,
- техническое обслуживание и поддержка оборудования: серверов, сетевого оборудования, хранилищ данных, обновление лицензий ПО, 
- энергопотребление,
- дополнительные сервисы: мониторинг производительности, резервное копирование, обеспечение безопасности и антивирусная защита.

Предположим, в нашей системе рост объема данных и базы пользователей происходил следующим образом:  
Год	Количество пользователей	Объём данных  
1	100	1 ТБ  
2	200	2 ТБ  
5	500	5 ТБ  

Предположим, над проектом работает следующая команда (зп за вычетом налога):  
Product Manager ~$3000/мес.  
Архитектор ~$4500/мес.  
Дизайнер ~$3200/мес.  
UX-исследователь ~$2900/мес.  
Фронтенд-разработчик ~$3500/мес.  
Бэкенд-разработчик ~$3500/мес.  
Команда разработки мобильной платформы iOS ~$10000/мес.  
Команда разработки мобильной платформы Android ~$10000/мес.  
QA-инженер ~$2500/мес.  
Специалист по DevOps ~$3000/мес.  
Data Analyst/Data Scientist ~$3000/мес.  
Маркетолог ~$2800/мес.  
Поддержка пользователей ~$1900/мес.  
Администратор баз данных ~$2300/мес.  

Итого расходы на команду в год **~$693,2k**.

## Стоимость владения системой в первый год
Первый год (начало проекта):

Лицензии: 
$
20000
$20000
Инструменты CI/CD: 
$
10
 
000
$10000
Закупка серверов (минимальная конфигурация): 
$
5
 
000
$5000
Документирование и обучение: 
$
15
 
000
$15000
Программирование и дизайн: 
$
100
 
000
$100000
Аренда облачной инфраструктуры: 
$
50
 
000
$50000
Поддержка пользователей: 
$
20
 
000
$20000
Зарплата сотрудников: 
$
200
 
000
$200000
Амортизация оборудования: 
$
1
 
000
$1000
Итого CAPEX: 
$
150
 
000
$150000.Итого OPEX: 
$
321
 
000
$321000.Общая стоимость владения в первом году: 
$
471
 
000
$471000.
## Стоимость владения системой во второй год

## Стоимость владения системой в пятый год

Будем считать что наша система разрабатывалась при помощи следующих специалистов с такими заробатными платами (вопрос налогообложения и отчислений опущен):

1 Product manager (250k).
1 Senior backend developer (250k).
1 Middle backend developer (150k).
1 Juniour backend developer (80k).
1 Senior frontend developer (250k).
1 Middle frontend developer (150k).
1 Juniour frontend developer (80k).
1 UI-designer (120k).
2 Data-science and ML developer (180k).
2 Middle QA (120k).
Будем считать что разработка ведется пол года (оптимистический срок), год (сбалансированный срок), два года (пессимистический срок). Исходим из того что был реализован средний сценарий и разработка проекта завершилась за год.

Итого за разработку было потрачено 4.570 млн руб в год.

Считается что поддержание системы стоит треть от стоимости разработки, тогда поддержание в системы в каждый из годов будет стоить 1.3 млн руб в год.

Сперва посчитаем то сколько данных будет хранить наше приложение, это нужно для того чтоб грамотно подобрать конфигурации для базы данных и не переплачивать за более дорогие и мощные instance.

Ввиду того что точно спрогнозировать (даже в рамках учебного проекта) поток потенциальных клиентов и то как они будут пользоваться приложением нереально, то для хоть каких-либо расчетов будем опираться на некие предположения.

Предположения для первого года работы для домена Authentification/API Getaway:

Количество регистрирующихся юзеров в день: 20.
Каждый юзер имеет в среднем 1 preference.
Каждый юзер подписан хотя бы на одного другого пользователя.
Тогда в первый год работы нам понадобится 0.9 GiB пространства в год.

image-20211218100036722

Предположения для первого года работы для домена Shop:

Так как 20 юзеров в день, то тогда 7200 юзеров в год.
Каждый юзер делает 1 order раз в сезон, итого 4 раза в год.
В каждом order находится хотя бы 3 OrderItems (товара).
Тогда в первый год работы нам понадобится 0.8 GiB пространства в год.

image-20211218101930610

Предположения для первого года работы для домена Content:

Каждый день пишется 2 новых статьи.
Каждую неделю пишется одна новая рекомендация.
Существует 50 различных тем.
Тогда в первый год работы нам понадобится 1.8 GiB пространства в год.

image-20211218103024096

Предположения для первого года работы домена Tracking:

Средний юзер тренируется хотя бы 2 раза в месяц.
Тренируются половина от числа всех пользователей.
Координаты записываются раз в секунду.
В среднем тренировка длится 30 минут.
У каждого юзера есть хотя бы один носимый девайс (часы, пульсометр и тд), которые тоже записывают данные о тренировке.
Каждый юзер создает 2 маршрута в год.
Каждый юзер при тренировке в среднем пересекает 2 маршрута пользователей системы.
Каждый маршрут состоит из 1000 ключевых точек.
Модуль Route домена Tracking будет потреблять 69 GiB в год:

image-20211218110515573

Модуль Train домена Tracking будет потреблять 3200 GiB в год:

image-20211218105645534

Итог для первого года работы: 3233 GiB пространства или 3.2 TiB.

Предположим что для второго года работы справдливы все допущения выше, но также предположим оптимистический полуторократный рост пользователей с 20 до 30 новых пользователей в день. В таком случае нам понадобится хранилище чтоб умещать данные за первый год работы (3.2 TiB) плюс пространство для информации, которая сгенеируется во втором году в размере 4.9 TiB (расчеты аналогичны тем же что и в первом году, поэтому в подробном виде приводиться не будут). Выходит, что во втором году у нас должен быть DB сервер баз данных, который вместит 8.1 TiB данных.

Чтобы расчитать стоимость владения системой на пятом году ее жизни, также предположим полуторократный рост пользователей в год вплоть до пятого. Тогда за третий год будет сгенерировано 7.3 TiB данных, за четвертый 11 TiB. И тогда в пятом будет сгенерировано 16.3 TiB данных при 100 новых пользователей в день. Также стоит учитывать данные накопленные за прошлые годы работы.

Рассчитаем стоимость, если мы пользуемся Google Cloud Platform как PaaS провайдеров нашей системы с учетом уровня нагрузки расчитанного выше. Также будем увеличивать среднее колличество рабочих инстансов App Engine от года к году.

Воспользовавшись калькулятором, предоставляемого самим Google мы получаем следующие расценки для первого года работы:

image-20211218121750516

Выходит, что стоимость услуг провайдера будет стоить 0.844 млн руб в год, плюс 1.3 млн руб на поддержание системы командой разработчиков или 2.14 млн в первый год работы (не разработки).

Во второй год работы будут следующие расценки на услуги провайдера:

image-20211218124318755

Выходит, что стоимость услуг провайдера будет стоить 2.136 млн руб в год, плюс 1.3 млн руб на поддержание системы командой разработчиков или 3.436 млн во второй год работы.

В пятый год работы системы стоимость будет следующая:

image-20211218125151211

Выходит, что стоимость услуг провайдера будет стоить 20.868 млн руб в год, плюс 1.3 млн руб на поддержание системы командой разработчиков или 22.168 млн в пятый год работы.

Прочие общие но важные допущения:

Важно что все расчеты предполагают ступенчатый рост по началу нового года, а не экспоненциальный.

При расчете количества данных сгенированных приложением Tracking существует допущение, что в каждом отдельном году трафик генируруют только новые пользователи. Таким образом реализовываеттся допущение некого естесственного оттока пользователей.

При расчете стоимости PaaS услуг от года к году кратно увеличвается количество одновременно работающих instance, размеров кеша, объемов исходящего трафика.

Все основные данные мы храним в Cloud SQL.

Вывод по стоимостным оценкам: траты на PaaS систему от года к году начинают расти в геометрической прогресии, тогда как стоимость поддержания системы командой разработчиков можно приравнять к некой константе, если мы не учитываем рост зарплат и инфляцию. Большую часть денег потребляет хранение данных.
